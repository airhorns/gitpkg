{"version":3,"file":"read-package-manifest.js","names":["_fs","_interopRequireDefault","require","_path","_bluebird","_semver","e","__esModule","default","readFile","bluebird","promisify","fs","readPackageManifest","pkgPath","packagePath","path","resolve","pkg","JSON","parse","scripts","validatePackageJSON","name","Error","version","semver","valid"],"sources":["../../../src/tasks/Task/read-package-manifest.js"],"sourcesContent":["import fs from 'fs';\nimport path from 'path';\nimport bluebird from 'bluebird';\nimport semver from 'semver';\n\nconst readFile = bluebird.promisify(fs.readFile);\n\nexport default async function readPackageManifest(pkgPath) {\n  const packagePath = path.resolve(pkgPath, 'package.json');\n  const pkg = JSON.parse(await readFile(packagePath, 'utf-8'));\n  pkg.scripts = pkg.scripts || {};\n  validatePackageJSON(pkg);\n  return pkg;\n}\n\nfunction validatePackageJSON(pkg) {\n  if (!pkg.name) {\n    throw new Error(\"Package doesn't have a name.\");\n  }\n\n  if (!pkg.version) {\n    throw new Error(\"Package doesn't have a version.\");\n  }\n\n  if (!semver.valid(pkg.version)) {\n    throw new Error('Invalid semver version.');\n  }\n}\n"],"mappings":";;;;;;AAAA,IAAAA,GAAA,GAAAC,sBAAA,CAAAC,OAAA;AACA,IAAAC,KAAA,GAAAF,sBAAA,CAAAC,OAAA;AACA,IAAAE,SAAA,GAAAH,sBAAA,CAAAC,OAAA;AACA,IAAAG,OAAA,GAAAJ,sBAAA,CAAAC,OAAA;AAA4B,SAAAD,uBAAAK,CAAA,WAAAA,CAAA,IAAAA,CAAA,CAAAC,UAAA,GAAAD,CAAA,KAAAE,OAAA,EAAAF,CAAA;AAE5B,MAAMG,QAAQ,GAAGC,iBAAQ,CAACC,SAAS,CAACC,WAAE,CAACH,QAAQ,CAAC;AAEjC,eAAeI,mBAAmBA,CAACC,OAAO,EAAE;EACzD,MAAMC,WAAW,GAAGC,aAAI,CAACC,OAAO,CAACH,OAAO,EAAE,cAAc,CAAC;EACzD,MAAMI,GAAG,GAAGC,IAAI,CAACC,KAAK,CAAC,MAAMX,QAAQ,CAACM,WAAW,EAAE,OAAO,CAAC,CAAC;EAC5DG,GAAG,CAACG,OAAO,GAAGH,GAAG,CAACG,OAAO,IAAI,CAAC,CAAC;EAC/BC,mBAAmB,CAACJ,GAAG,CAAC;EACxB,OAAOA,GAAG;AACZ;AAEA,SAASI,mBAAmBA,CAACJ,GAAG,EAAE;EAChC,IAAI,CAACA,GAAG,CAACK,IAAI,EAAE;IACb,MAAM,IAAIC,KAAK,CAAC,8BAA8B,CAAC;EACjD;EAEA,IAAI,CAACN,GAAG,CAACO,OAAO,EAAE;IAChB,MAAM,IAAID,KAAK,CAAC,iCAAiC,CAAC;EACpD;EAEA,IAAI,CAACE,eAAM,CAACC,KAAK,CAACT,GAAG,CAACO,OAAO,CAAC,EAAE;IAC9B,MAAM,IAAID,KAAK,CAAC,yBAAyB,CAAC;EAC5C;AACF","ignoreList":[]}